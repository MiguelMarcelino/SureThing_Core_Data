syntax = "proto3";

package pt.ulisboa.tecnico.surethingcore;

option java_multiple_files = true;
option java_package = "pt.ulisboa.tecnico.surethingcore.locationclaim";
option java_outer_classname = "SureThingLocationClaimEntities";

import "google/protobuf/timestamp.proto";
import "google/protobuf/any.proto";


enum EvidenceType{
    WIFI = 0;
    GPS = 1;
    BLUETOOTH = 2;
    BEACON = 3;
    AMBIENTSENSOR = 4;
}

message LocationClaim{

	// prover unique id - pseudonyms -- identity scheme
	int64 proverId = 1;
	
	// prover's location - lat, long - name, hierarchy of names, ... -- location schema
	string location = 2;
	
    // type of the evidence
    EvidenceType evidenceType = 3;

	// location evidence ??  - Screen signing , photo, ... -- evidence scheme
	repeated google.protobuf.Any claimEvidence = 4;

    // timestamp of location claim - time/date, time interval, ... -- date scheme
	google.protobuf.Timestamp timestamp = 5;
	
	// prover's signature
	bytes signature = 6;

}

// WiFi evidence : One possible definition 
message ClaimEvidence {

    // unique id
    int64 id = 1;

    // Access point (AP) definition
    message AP{

        // AP identifier
        string ssid = 1;

        // measured RSSI 
        int64 rssi = 2;
    }

    // detected AP
    AP ap = 2;

    // ...
}



