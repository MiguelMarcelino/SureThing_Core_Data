syntax = "proto3";

package pt.ulisboa.tecnico.surethingcore;

option java_multiple_files = true;
option java_package = "pt.ulisboa.tecnico.surethingcore.locationclaim";
option java_outer_classname = "SureThingLocationClaimEntities";

import "google/protobuf/timestamp.proto";
import "google/protobuf/any.proto";


enum EvidenceType {
    WIFI = 0;
    GPS = 1;
    BLUETOOTH = 2;
    BEACON = 3;
    AMBIENTSENSOR = 4;
}

enum IdentityType {
    NUMERIC = 0;
    FREE_TEXT = 1;
    COMMON_NAME = 2; // X-509 name syntax
}

enum LocationType {
    LAT_LONG = 0;
    POI_NAME = 1;
    PROXIMITY_TO_POI = 2;
    OLC_CODE = 3;
}

enum TimeType {
    TIMESTAMP = 0;
    INTERVAL = 1; //start and end timestamps
    RELATIVE_TO_EPOCH = 2;
}

message LocationClaim{

    // unique identifier for claim
    string uuid = 0;

	// prover unique id - pseudonyms -- identity scheme
	int64 proverId = 1;
	
	// prover's location - lat, long - name, hierarchy of names, ... -- location schema
	string location = 2;
	
    // type of the evidence
    EvidenceType evidenceType = 3;

	// location evidence ??  - Screen signing , photo, ... -- evidence scheme
	repeated google.protobuf.Any claimEvidence = 4;

    // timestamp of location claim - time/date, time interval, ... -- date scheme
	google.protobuf.Timestamp timestamp = 5;
}

message LocationChain {
    current
    previous
}

message SignedLocationClaim{
    LocationClaim claim;
	// prover's signature
	Signature signature = 6;
}

message Signature {
    string CryptoAlgo;
    int64 nonce;
    bytes value;
    // Any metaData;
}

// WiFi evidence : One possible definition 
message ClaimEvidence {

    // unique id
    int64 id = 1;

    // Access point (AP) definition
    message AP{

        // AP identifier
        string ssid = 1;

        // measured RSSI 
        int64 rssi = 2;
    }

    // detected AP
    repeated AP ap = 2;

    // ...
}



